{"version":3,"sources":["dashboard/src/Dashboard.js"],"names":["$","Craft","Dashboard","Garnish","Base","extend","$widgetManagerBtn","widgetTypes","grid","widgets","widgetManager","widgetAdminTable","widgetSettingsModal","$doc","ready","addListener","data","proxy","this","$grid","property","defaultValue","menu","on","getTypeInfo","type","handleNewWidgetOptionSelect","e","$option","toLowerCase","append","settingsNamespace","Math","floor","random","settingsHtml","replace","settingsJs","$gridItem","$container","class","data-type","addClass","name","value","Widget","t","length","$items","scrollContainerToElement","response","role","text","appendTo","$noWidgets","$widgets","widget","noObjectsSelector","insertAfter","HUD","removeClass","lastWidget","postActionRequest","textStatus","success","i","ids","prependTo","showWidgetManager","show","resetItemOrder","find","$form","$bod","$table","eq","id","getManagerRow","$tbody","hudClass","onShow","onHide","AdminTable","tableSelector","sortable","reorderAction","deleteAction","onReorderItems","container","initSettingsFn","parent","children","onDeleteItem","$front","$settingsContainer","$btnsContainer","$title","getColspan","$heading","$bodyContainer","$settingsForm","$settingsErrorList","setSettingsHtml","subtitle","totalCols","$settingsBtn","showingSettings","refreshSettings","requestAnimationFrame","initUiElements","title","window","dashboard","velocity","height","$subtitle","preventDefault","hasClass","$settingsSpinner","onShowBack","remove","initBackUi","displayNotice","$back","destroy","update","hideSettings","displayError","setColspan","colspan","refreshCols","info","addRow","showSettings","complete","appendHeadHtml","appendFootHtml","footHtml","serialize","cancelSettings","action","cp","errors","ui","getManagerRowLabel","attr","prepend","createColspanButtons","html","$colspanButtons","bodyHtml","currentMaxColspan","currentColspan","headHtml","cssClass","removeListener","$button","ev","add","nextAll","setTimeout","trigger","setWidgetColspan","newColspan","$activeButton","escapeHtml","WidgetColspanPicker","$row","typeName","base","removeItems","maxColspan","totalGridCols","init","$td","currentTarget","handleGridRefresh","min","num","prevAll","jQuery"],"mappings":"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","file":"Dashboard.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    /**\n     * Dashboard class\n     */\n    Craft.Dashboard = Garnish.Base.extend(\n        {\n            $grid: null,\n            $widgetManagerBtn: null,\n\n            widgetTypes: null,\n            grid: null,\n            widgets: null,\n            widgetManager: null,\n            widgetAdminTable: null,\n            widgetSettingsModal: null,\n\n            init: function(widgetTypes) {\n                this.widgetTypes = widgetTypes;\n                this.widgets = {};\n\n                this.$widgetManagerBtn = $('#widgetManagerBtn');\n\n                this.addListener(this.$widgetManagerBtn, 'click', 'showWidgetManager');\n\n                Garnish.$doc.ready($.proxy(function() {\n                    this.$grid = $('#dashboard-grid');\n                    this.grid = this.$grid.data('grid');\n                    $('#newwidgetmenubtn').data('menubtn').menu.on('optionselect', $.proxy(this, 'handleNewWidgetOptionSelect'));\n                }, this));\n            },\n\n            getTypeInfo: function(type, property, defaultValue) {\n                if (property) {\n                    if (typeof this.widgetTypes[type][property] === 'undefined') {\n                        return defaultValue;\n                    }\n                    else {\n                        return this.widgetTypes[type][property];\n                    }\n                }\n                else {\n                    return this.widgetTypes[type];\n                }\n            },\n\n            handleNewWidgetOptionSelect: function(e) {\n                var $option = $(e.selectedOption),\n                    type = $option.data('type'),\n                    settingsNamespace = 'newwidget' + Math.floor(Math.random() * 1000000000) + '-settings',\n                    settingsHtml = this.getTypeInfo(type, 'settingsHtml', '').replace(/__NAMESPACE__/g, settingsNamespace),\n                    settingsJs = this.getTypeInfo(type, 'settingsJs', '').replace(/__NAMESPACE__/g, settingsNamespace),\n                    $gridItem = $('<div class=\"item\" data-colspan=\"1\" style=\"display: block\">'),\n                    $container = $('<div/>', {\n                      'class': 'widget new loading-new scaleout',\n                      'data-type': type,\n                    })\n                      .addClass(type.toLowerCase())\n                      .append(\n                        $('<div/>', {'class': 'front'})\n                          .append(\n                            $('<div/>', {'class': 'pane'})\n                              .append(\n                                $('<div/>', {'class': 'spinner body-loading'})\n                              )\n                              .append(\n                                $('<div/>', {'class': 'widget-heading'})\n                                  .append('<h2/>')\n                                  .append('<h5/>')\n                              )\n                              .append(\n                                $('<div/>', {'class': 'body'})\n                              )\n                              .append(\n                                $('<div/>', {'class': 'settings icon hidden'})\n                              )\n                          )\n                      )\n                      .append(\n                        $('<div/>', {'class': 'back'})\n                          .append(\n                            $('<form/>', {'class': 'pane'})\n                              .append(\n                                $('<input/>', {\n                                  type: 'hidden',\n                                  name: 'type',\n                                  value: type,\n                                })\n                              )\n                              .append(\n                                $('<input/>', {\n                                  type: 'hidden',\n                                  name: 'settingsNamespace',\n                                  value: settingsNamespace,\n                                })\n                              )\n                              .append(\n                                $('<h2/>', {\n                                  text: Craft.t('app', '{type} Settings', {\n                                    type: $option.data('name')\n                                  }),\n                                })\n                              )\n                              .append(\n                                $('<div/>', {'class': 'settings'})\n                              )\n                              .append('<hr/>')\n                              .append(\n                                $('<div/>', {'class': 'buttons clearafter'})\n                                  .append(\n                                    $('<input/>', {\n                                      type: 'submit',\n                                      'class': 'btn submit',\n                                      value: Craft.t('app', 'Save'),\n                                    })\n                                  )\n                                  .append(\n                                    $('<div/>', {\n                                      'class': 'btn',\n                                      role: 'button',\n                                      text: Craft.t('app', 'Cancel')\n                                    })\n                                  )\n                                  .append(\n                                    $('<div/>', {'class': 'spinner hidden'})\n                                  )\n                              )\n                          )\n                      )\n                      .appendTo($gridItem);\n\n                if (settingsHtml) {\n                    $container.addClass('flipped');\n                }\n                else {\n                    $container.addClass('loading');\n                }\n\n                var widget = new Craft.Widget($container, settingsHtml.replace(/__NAMESPACE__/g, settingsNamespace), function() {\n                    eval(settingsJs);\n                });\n\n                // Append the new widget after the last one\n                // (can't simply append it to the grid container, since that will place it after the resize listener object)\n\n                if (this.grid.$items.length) {\n                    $gridItem.insertAfter(this.grid.$items.last());\n                }\n                else {\n                    $gridItem.prependTo(this.grid.$container);\n                }\n\n                this.grid.addItems($gridItem);\n                Garnish.scrollContainerToElement($gridItem);\n\n                $container.removeClass('scaleout');\n\n                if (!settingsHtml) {\n                    var data = {\n                        type: type\n                    };\n\n                    Craft.postActionRequest('dashboard/create-widget', data, function(response, textStatus) {\n                        if (textStatus === 'success' && response.success) {\n                            $container.removeClass('loading');\n                            widget.update(response);\n                        }\n                        else {\n                            widget.destroy();\n                        }\n                    });\n                }\n            },\n\n            showWidgetManager: function() {\n                if (!this.widgetManager) {\n                    var $widgets = this.$grid.find('> .item > .widget'),\n                        $form = $(\n                            '<form method=\"post\" accept-charset=\"UTF-8\">' +\n                            '<input type=\"hidden\" name=\"action\" value=\"widgets/save-widget\"/>' +\n                            '</form>'\n                        ).appendTo(Garnish.$bod),\n                        $noWidgets = $('<p id=\"nowidgets\"' + ($widgets.length ? ' class=\"hidden\"' : '') + '>' + Craft.t('app', 'You don’t have any widgets yet.') + '</p>').appendTo($form),\n                        $table = $('<table class=\"data' + (!$widgets.length ? ' hidden' : '') + '\"/>').appendTo($form),\n                        $tbody = $('<tbody/>').appendTo($table);\n\n                    for (var i = 0; i < $widgets.length; i++) {\n                        var $widget = $widgets.eq(i),\n                            widget = $widget.data('widget');\n\n                        // Make sure it's actually saved\n                        if (!widget || !widget.id) {\n                            continue;\n                        }\n\n                        widget.getManagerRow().appendTo($tbody);\n                    }\n\n                    this.widgetManager = new Garnish.HUD(this.$widgetManagerBtn, $form, {\n                        hudClass: 'hud widgetmanagerhud',\n                        onShow: $.proxy(function() {\n                            this.$widgetManagerBtn.addClass('active');\n                        }, this),\n                        onHide: $.proxy(function() {\n                            this.$widgetManagerBtn.removeClass('active');\n                        }, this)\n                    });\n\n                    this.widgetAdminTable = new Craft.AdminTable({\n                        tableSelector: $table,\n                        noObjectsSelector: $noWidgets,\n                        sortable: true,\n                        reorderAction: 'dashboard/reorder-user-widgets',\n                        deleteAction: 'dashboard/delete-user-widget',\n                        onReorderItems: $.proxy(function(ids) {\n                            var lastWidget = null;\n\n                            for (var i = 0; i < ids.length; i++) {\n                                var widget = this.widgets[ids[i]];\n\n                                if (!lastWidget) {\n                                    widget.$gridItem.prependTo(this.$grid);\n                                }\n                                else {\n                                    widget.$gridItem.insertAfter(lastWidget.$gridItem);\n                                }\n\n                                lastWidget = widget;\n                            }\n\n                            this.grid.resetItemOrder();\n                        }, this),\n                        onDeleteItem: $.proxy(function(id) {\n                            var widget = this.widgets[id];\n\n                            widget.destroy();\n                        }, this)\n                    });\n                }\n                else {\n                    this.widgetManager.show();\n                }\n            }\n        });\n\n\n    /**\n     * Dashboard Widget class\n     */\n    Craft.Widget = Garnish.Base.extend(\n        {\n            $container: null,\n            $gridItem: null,\n\n            $front: null,\n            $settingsBtn: null,\n            $title: null,\n            $subtitle: null,\n            $heading: null,\n            $bodyContainer: null,\n\n            $back: null,\n            $settingsForm: null,\n            $settingsContainer: null,\n            $settingsSpinner: null,\n            $settingsErrorList: null,\n\n            id: null,\n            type: null,\n            title: null,\n            subtitle: null,\n\n            totalCols: null,\n            settingsHtml: null,\n            initSettingsFn: null,\n            showingSettings: false,\n\n            colspanPicker: null,\n\n            init: function(container, settingsHtml, initSettingsFn) {\n                this.$container = $(container);\n                this.$gridItem = this.$container.parent();\n\n                // Store a reference to this object on the container element\n                this.$container.data('widget', this);\n\n                // Do a little introspection\n                this.id = this.$container.data('id');\n                this.type = this.$container.data('type');\n                this.title = this.$container.data('title');\n\n                if (this.id) {\n                    // Store a reference to this object on the main Dashboard object\n                    window.dashboard.widgets[this.id] = this;\n                }\n\n                this.$front = this.$container.children('.front');\n                this.$settingsBtn = this.$front.find('> .pane > .icon.settings');\n                this.$heading = this.$front.find('> .pane > .widget-heading');\n                this.$title = this.$heading.find('> h2');\n                this.$subtitle = this.$heading.find('> h5');\n                this.$bodyContainer = this.$front.find('> .pane > .body');\n\n                this.setSettingsHtml(settingsHtml, initSettingsFn);\n\n                if (!this.$container.hasClass('flipped')) {\n                    this.onShowFront();\n                }\n                else {\n                    this.initBackUi();\n                    this.refreshSettings();\n                    this.onShowBack();\n                }\n\n                this.addListener(this.$settingsBtn, 'click', 'showSettings');\n            },\n\n            initBackUi: function() {\n                this.$back = this.$container.children('.back');\n                this.$settingsForm = this.$back.children('form');\n                this.$settingsContainer = this.$settingsForm.children('.settings');\n                var $btnsContainer = this.$settingsForm.children('.buttons');\n                this.$settingsSpinner = $btnsContainer.children('.spinner');\n\n                this.addListener($btnsContainer.children('.btn:nth-child(2)'), 'click', 'cancelSettings');\n                this.addListener(this.$settingsForm, 'submit', 'saveSettings');\n            },\n\n            getColspan: function() {\n                return this.$gridItem.data('colspan');\n            },\n\n            setColspan: function(colspan) {\n                this.$gridItem.data('colspan', colspan);\n                window.dashboard.grid.refreshCols(true);\n            },\n\n            getTypeInfo: function(property, defaultValue) {\n                return window.dashboard.getTypeInfo(this.type, property, defaultValue);\n            },\n\n            setSettingsHtml: function(settingsHtml, initSettingsFn) {\n                this.settingsHtml = settingsHtml;\n                this.initSettingsFn = initSettingsFn;\n\n                if (this.settingsHtml) {\n                    this.$settingsBtn.removeClass('hidden');\n                }\n                else {\n                    this.$settingsBtn.addClass('hidden');\n                }\n            },\n\n            refreshSettings: function() {\n                this.$settingsContainer.html(this.settingsHtml);\n\n                Garnish.requestAnimationFrame($.proxy(function() {\n                    Craft.initUiElements(this.$settingsContainer);\n                    this.initSettingsFn();\n                }, this));\n            },\n\n            showSettings: function() {\n                if (!this.$back) {\n                    this.initBackUi();\n                }\n\n                // Refresh the settings every time\n                this.refreshSettings();\n\n                this.$container\n                    .addClass('flipped')\n                    .velocity({height: this.$back.height()}, {\n                        complete: $.proxy(this, 'onShowBack')\n                    });\n            },\n\n            hideSettings: function() {\n                this.$container\n                    .removeClass('flipped')\n                    .velocity({height: this.$front.height()}, {\n                        complete: $.proxy(this, 'onShowFront')\n                    });\n            },\n\n            saveSettings: function(e) {\n                e.preventDefault();\n                this.$settingsSpinner.removeClass('hidden');\n\n                var action = this.$container.hasClass('new') ? 'dashboard/create-widget' : 'dashboard/save-widget-settings',\n                    data = this.$settingsForm.serialize();\n\n                Craft.postActionRequest(action, data, $.proxy(function(response, textStatus) {\n                    this.$settingsSpinner.addClass('hidden');\n\n                    if (textStatus === 'success') {\n                        if (this.$settingsErrorList) {\n                            this.$settingsErrorList.remove();\n                            this.$settingsErrorList = null;\n                        }\n\n                        if (response.success) {\n                            Craft.cp.displayNotice(Craft.t('app', 'Widget saved.'));\n\n                            // Make sure the widget is still allowed to be shown, just in case\n                            if (!response.info) {\n                                this.destroy();\n                            }\n                            else {\n                                this.update(response);\n                                this.hideSettings();\n                            }\n                        }\n                        else {\n                            Craft.cp.displayError(Craft.t('app', 'Couldn’t save widget.'));\n\n                            if (response.errors) {\n                                this.$settingsErrorList = Craft.ui.createErrorList(response.errors)\n                                    .insertAfter(this.$settingsContainer);\n                            }\n                        }\n                    }\n                }, this));\n            },\n\n            update: function(response) {\n                this.title = response.info.title;\n                this.subtitle = response.info.subtitle;\n\n                // Is this a new widget?\n                if (this.$container.hasClass('new')) {\n                    // Discover ourself\n                    this.id = response.info.id;\n\n                    this.$container\n                        .attr('id', 'widget' + this.id)\n                        .removeClass('new loading-new');\n\n                    if (this.$settingsForm) {\n                        this.$settingsForm.prepend('<input type=\"hidden\" name=\"widgetId\" value=\"' + this.id + '\"/>');\n                    }\n\n                    // Store a reference to this object on the main Dashboard object, now that the widget actually exists\n                    window.dashboard.widgets[this.id] = this;\n\n                    if (window.dashboard.widgetAdminTable) {\n                        window.dashboard.widgetAdminTable.addRow(this.getManagerRow());\n                    }\n                }\n                else {\n                    if (window.dashboard.widgetAdminTable) {\n                        window.dashboard.widgetAdminTable.$tbody.children('[data-id=\"' + this.id + '\"]:first').children('td:nth-child(2)').html(this.getManagerRowLabel());\n                    }\n                }\n\n                if (!this.title && !this.subtitle) {\n                    this.$heading.remove();\n                } else {\n                    if (this.title) {\n                        this.$title.text(this.title);\n                    } else {\n                        this.$title.remove();\n                    }\n\n                    if (this.subtitle) {\n                        this.$subtitle.text(this.subtitle);\n                    } else {\n                        this.$subtitle.remove();\n                    }\n                }\n\n                this.$bodyContainer.html(response.info.bodyHtml);\n\n                // New colspan?\n                if (response.info.colspan != this.getColspan()) {\n                    this.setColspan(response.info.colspan);\n                    Garnish.scrollContainerToElement(this.$gridItem);\n                }\n\n                Craft.initUiElements(this.$bodyContainer);\n                Craft.appendHeadHtml(response.headHtml);\n                Craft.appendFootHtml(response.footHtml);\n\n                this.setSettingsHtml(response.info.settingsHtml, function() {\n                    eval(response.info.settingsJs);\n                });\n            },\n\n            cancelSettings: function() {\n                if (this.id) {\n                    this.hideSettings();\n                }\n                else {\n                    this.destroy();\n                }\n            },\n\n            onShowFront: function() {\n                this.showingSettings = false;\n                this.removeListener(this.$back, 'resize');\n                this.addListener(this.$front, 'resize', 'updateContainerHeight');\n            },\n\n            onShowBack: function() {\n                this.showingSettings = true;\n                this.removeListener(this.$front, 'resize');\n                this.addListener(this.$back, 'resize', 'updateContainerHeight');\n\n                // Focus on the first input\n                setTimeout($.proxy(function() {\n                    this.$settingsForm.find(':focusable:first').trigger('focus');\n                }, this), 1);\n            },\n\n            updateContainerHeight: function() {\n                this.$container.height((this.showingSettings ? this.$back : this.$front).height());\n            },\n\n            getManagerRow: function() {\n                var $row = $(\n                    '<tr data-id=\"' + this.id + '\" data-name=\"' + Craft.escapeHtml(this.title) + '\">' +\n                    '<td class=\"widgetmanagerhud-icon\">' + this.getTypeInfo('iconSvg') + '</td>' +\n                    '<td>' + this.getManagerRowLabel() + '</td>' +\n                    '<td class=\"widgetmanagerhud-col-colspan-picker thin\"></td>' +\n                    '<td class=\"widgetmanagerhud-col-move thin\"><a class=\"move icon\" title=\"' + Craft.t('app', 'Reorder') + '\" role=\"button\"></a></td>' +\n                    '<td class=\"thin\"><a class=\"delete icon\" title=\"' + Craft.t('app', 'Delete') + '\" role=\"button\"></a></td>' +\n                    '</tr>'\n                );\n\n                // Initialize the colspan picker\n                this.colspanPicker = new Craft.WidgetColspanPicker(this, $row.find('> td.widgetmanagerhud-col-colspan-picker'));\n\n                return $row;\n            },\n\n            getManagerRowLabel: function() {\n                var typeName = this.getTypeInfo('name');\n\n                return Craft.escapeHtml(this.title) + (this.title !== typeName ? ' <span class=\"light\">(' + typeName + ')</span>' : '');\n            },\n\n            destroy: function() {\n                delete window.dashboard.widgets[this.id];\n                this.$container.addClass('scaleout');\n                this.base();\n\n                setTimeout($.proxy(function() {\n                    window.dashboard.grid.removeItems(this.$gridItem);\n                    this.$gridItem.remove();\n                }, this), 200);\n            }\n        });\n\n\n    /**\n     * Widget colspan picker class\n     */\n    Craft.WidgetColspanPicker = Garnish.Base.extend(\n        {\n            widget: null,\n            maxColspan: null,\n\n            $container: null,\n            $colspanButtons: null,\n\n            totalGridCols: null,\n\n            init: function(widget, $td) {\n                this.widget = widget;\n                this.$container = $('<div class=\"colspan-picker\"/>').appendTo($td);\n                this.maxColspan = this.widget.getTypeInfo('maxColspan');\n\n                this.totalGridCols = window.dashboard.grid.totalCols;\n                this.createColspanButtons();\n\n                window.dashboard.grid.on('refreshCols', $.proxy(this, 'handleGridRefresh'));\n\n                this.addListener(this.$container, 'mouseover', function(ev) {\n                    $(ev.currentTarget).addClass('hover');\n                });\n\n                this.addListener(this.$container, 'mouseout', function(ev) {\n                    $(ev.currentTarget).removeClass('hover');\n                });\n            },\n\n            handleGridRefresh: function() {\n                // Have the number of columns changed?\n                if (this.totalGridCols !== (this.totalGridCols = window.dashboard.grid.totalCols)) {\n                    // Remove the current buttons\n                    if (this.$colspanButtons) {\n                        this.$colspanButtons.remove();\n                    }\n\n                    // Recreate them\n                    this.createColspanButtons();\n                }\n            },\n\n            createColspanButtons: function() {\n                // Figure out what the current max colspan and widget colspan are.\n                var currentMaxColspan = this.maxColspan ? Math.min(this.maxColspan, this.totalGridCols) : this.totalGridCols,\n                    currentColspan = Math.min(this.widget.getColspan(), currentMaxColspan);\n\n                // Create the buttons\n                for (var i = 1; i <= currentMaxColspan; i++) {\n                    var cssClass = '';\n\n                    if (i <= currentColspan) {\n                        cssClass = 'active';\n                    }\n\n                    if (i === currentColspan) {\n                        cssClass += (cssClass ? ' ' : '') + 'last';\n                    }\n\n                    $('<a/>', {\n                        title: Craft.t('app', '{num, number} {num, plural, =1{column} other{columns}}', {\n                            num: i,\n                        }),\n                        role: 'button',\n                        'class': cssClass,\n                        data: {colspan: i}\n                    }).appendTo(this.$container);\n                }\n\n                // Add listeners\n                this.$colspanButtons = this.$container.children();\n\n                this.addListener(this.$colspanButtons, 'mouseover', function(ev) {\n                    var $button = $(ev.currentTarget);\n                    $button.add($button.prevAll()).addClass('highlight');\n                    $button.nextAll().removeClass('highlight');\n                });\n\n                this.addListener(this.$colspanButtons, 'mouseout', function() {\n                    this.$colspanButtons.removeClass('highlight');\n                });\n\n                this.addListener(this.$colspanButtons, 'click', $.proxy(function(ev) {\n                    this.setWidgetColspan($.data(ev.currentTarget, 'colspan'));\n                }, this));\n            },\n\n            setWidgetColspan: function(newColspan) {\n                // Update the button .active and .last classes\n                this.$colspanButtons.removeClass('last active');\n                var $activeButton = this.$colspanButtons.eq(newColspan - 1);\n                $activeButton.add($activeButton.prevAll()).addClass('active');\n                $activeButton.addClass('last');\n\n                // Update the widget and grid\n                this.widget.setColspan(newColspan);\n                window.dashboard.grid.refreshCols(true);\n\n                // Save the change\n                var data = {\n                    id: this.widget.id,\n                    colspan: newColspan\n                };\n\n                Craft.postActionRequest('dashboard/change-widget-colspan', data, function(response, textStatus) {\n                    if (textStatus === 'success' && response.success) {\n                        Craft.cp.displayNotice(Craft.t('app', 'Widget saved.'));\n                    }\n                    else {\n                        Craft.cp.displayError(Craft.t('app', 'Couldn’t save widget.'));\n                    }\n                });\n            }\n        });\n})(jQuery);\n"]}