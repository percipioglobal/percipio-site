{%- import '_macros/atoms' as atom -%}

{# Eager Load categories based on entry types #}
{%- if entry.type == 'news' -%}
    {%- do craft.eagerBeaver.eagerLoadElements(entry, [
        'newsCategory'
        ]) 
    -%}
{%- endif -%}

{# Load needed images #}
{%- set teaserImage = content.teaserImage[0] ?? placeholder.teaserPlaceholder[0] -%}
{%- set news = content.type == 'news' ? true : false -%}

{%- minify -%}
    <div class="bg-red-500 flex flex-col relative h-full w-full mb-8 md:mb-0">
        
        <div class="relative">
            {%- if news -%}
                {{- atom.teaser_image(teaserImage, teaserImage.title, news ? 'is4by3' : 'is2by1' ) -}}
                <div class="absolute bottom-0 p-8">
                    <span class="uppercase bg-secondary-500 px-4 py-2 rounded-full font-secondary text-white-100 text-xs tracking-wide font-medium">
                        {{- content.newsCategory[0].title ?? 'No Category' }}
                    </span>
                </div>
            {%- else -%}
                <div class="img is4by3 bg-white-90">
                    {{- atom.teaser_image(teaserImage, teaserImage.title, news ? 'is4by3' : 'is2by1' ) -}}
                    <div class="absolute top-0 p-8">
                        <h3 class="text-4xl text-black-100 font-semibold break-words">
                            <a href="{{- content.url -}}">
                                {{- atom.text(content.title) -}}
                            </a>
                        </h3>
                    </div>
                </div>
            {%- endif -%}
        </div>

        <div class="{{ news ? 'bg-white-90' : 'bg-primary-500' }} h-full text-left">
            
            <div class="p-8 flex flex-col h-full">

                {%- if news -%}
                    <div class="text-xs leading-tight {{ news ? 'text-black-100' : 'text-white-100' }} tracking-wider mb-8">
                        <address rel="author" class="text-2xl font-primary font-medium leading-none not-italic mb-1 ">{{- content.author -}}</address>
                        <time datetime="{{ entry.postDate|date('c') }}" class="text-xs font-primary font-medium uppercase tracking-wide leading-normal">{{- atom.formatDate(content.postDate) -}}</time>
                    </div>
                {%- endif -%}

                <h4 class="break-words text-2xl font-secondary {{ news ? 'text-black-100' : 'text-white-100' }} font-semibold leading-tight {{ news ? 'mb-4' : '' -}}">
                    <a href="{{- content.url -}}">
                        {%- if news -%}
                            {{- atom.text(content.title) -}}
                        {%- else -%}
                            {{- atom.text(content.description) -}}
                        {%- endif -%}
                    </a>
                </h4>

            </div>
            
        </div>
        
        {# URL covering entire card #}
        <div>
            
            <a href="{{- url(alias('@web/' ~ content.uri)) -}}" class="absolute block top-0 left-0 h-full w-full z-1">
                <span class="sr-only">
                    {{- "Discover" | t }} {{ atom.text(content.title) }} {{ content.newsCategory[0].title ?? '' -}}
                </span>
            </a>
            
        </div>      
        
    </div>
{%- endminify -%}