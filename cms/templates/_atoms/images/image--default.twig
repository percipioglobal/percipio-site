{%- extends '_atoms/images/image--props' -%}

{#
    ### PROPERTIES ###
    ------------------

    alt: (STR) -- The alt text
    author: (STR) -- The author of the image ( optional )
    caption: (STR) -- The caption text ( optional )
    image: (OBJ) -- Pass through the image object
    optimized: (STR) -- the specific optimized field on the image (required)
    placeholder: (OBJ) -- The object that contains all placeholders ( required )
    ratio: (STR) -- Give the aspect ratio in the correct format eg. is1by1 / is16by9 ( optional )
    sizes: (ARR) -- sizes array for responsive images
    source: (STR) -- The image source ( optional )
    utilities: (STR) -- the specific TW spacing utilities to add

#}

{%- set props = props|merge({
    optimized: options.image.optimizeDefault ??? null,
    placeholder: options.placeholders.cardPlaceholder.first.optimizeDefault,
    ratio: options.ratio ??? 'aspect-4/5',
}) -%}

{%- block image -%}
    {%- minify -%}

        <figure role="figure" aria-labelledby="{{- props.alt ~ '-' ~ props.image.id ??? props.placeholder.id -}}">

            <picture class="{{ props.ratio -}}">

                <source
                    data-srcset="{{- props.optimized.srcsetWebP() ??? props.placeholder.srcsetWebP() -}}"
                    sizes="{%- for size in props.sizes -%}{{- not loop.last ? size ~ ',' : size -}}{%- endfor -%}"
                    type="image/webp"
                />

                <source
                    data-srcset="{{- props.optimized.srcset() ??? props.placeholder.srcset() -}}"
                    sizes="{%- for size in props.sizes -%}{{- not loop.last ? size ~ ',' : size -}}{%- endfor -%}"
                />

                <img
                    src="{{- props.optimized.placeholderImage() ??? props.placeholder.placeholderImage() -}}"
                    data-src="{{- props.optimized.src() ??? props.placeholder.src() -}}"
                    data-srcset="{{- props.optimized.srcset() ??? props.placeholder.srcset() -}}"
                    sizes="{%- for size in props.sizes -%}{{- not loop.last ? size ~ ',' : size -}}{%- endfor -%}"
                    class="lazyload {{ props.utilities -}}"
                    loading="lazy"
                    alt="{{- props.alt -}}"
                />

            </picture>

                {# {%- if values.caption -%}

                    {{- render.atom('text', 'caption', {
                        caption: values.caption,
                        author: values.author,
                        source: values.source,
                        id: values.alt ~ '-' ~ values.image.id,
                        textColour: options.textColour ??? 'gray-500',
                    }) -}}

                {%- endif -%} #}

        </figure>

    {%- endminify -%}
{%- endblock -%}
