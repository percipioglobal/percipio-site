{%- do craft.eagerBeaver.eagerLoadElements(entry,
    [
        'pageBuilder',
        'pageBuilder.contentCta',
        'pageBuilder.contentCta:image'
    ])
-%}

{%- minify -%}

    {%- for block in content.pageBuilder -%}

        {%- switch block.type -%}

            {%- case 'contentCta' -%}

                {%- set background = swatch(block.background) -%}
                {%- set component = '_molecules/ctas/cta--light' -%}

                {%- if block.image|length -%}
                    {%- set component = '_molecules/ctas/cta--image' -%}
                {%- else -%}
                    {%- set component = '_molecules/ctas/cta--text' -%}
                {%- endif -%}


                {%- include component ignore missing with {
                    heading: block.heading ??? '',
                    content: block.body ??? '',
                    button: block.target ??? null,
                    background: background.primary ?? 'white',
                    image: block.image ??? null
                } -%}

        {%- endswitch -%}

    {%- endfor -%}

{%- endminify -%}
